<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Inception scores - Seungjun Lee</title>
<meta name="description" content="Inception Score Papers    Improved techniques for training GANs (https://arxiv.org/pdf/1606.03498.pdf)   A Note on the Inception Score (https://arxiv.org/pdf/1801.01973.pdf)">


  <meta name="author" content="Seungjun Lee">
  
  <meta property="article:author" content="Seungjun Lee">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Seungjun Lee">
<meta property="og:title" content="Inception scores">
<meta property="og:url" content="http://localhost:4000/deep-learning/inception-scores/">


  <meta property="og:description" content="Inception Score Papers    Improved techniques for training GANs (https://arxiv.org/pdf/1606.03498.pdf)   A Note on the Inception Score (https://arxiv.org/pdf/1801.01973.pdf)">







  <meta property="article:published_time" content="2022-06-08T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/deep-learning/inception-scores/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Seungjun Lee",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Seungjun Lee Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Seungjun Lee
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://seungjunlee96.github.io/deep-learning/">Deep Learning</a>
            </li><li class="masthead__menu-item">
              <a href="http://127.0.0.1:4000/about">About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/about/profile.jpg" alt="Seungjun Lee" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Seungjun Lee</h3>
    
    
      <div class="author__bio" itemprop="description">
        

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Seoul, Republic of Korea</span>
        </li>
      

      
        
          
        
          
        
          
        
          
        
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Inception scores">
    <meta itemprop="description" content="Inception ScorePapers  Improved techniques for training GANs (https://arxiv.org/pdf/1606.03498.pdf)  A Note on the Inception Score (https://arxiv.org/pdf/1801.01973.pdf)">
    <meta itemprop="datePublished" content="2022-06-08T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Inception scores
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <h1 id="inception-score">Inception Score</h1>
<p>Papers</p>
<ol>
  <li>Improved techniques for training GANs (https://arxiv.org/pdf/1606.03498.pdf)</li>
  <li>A Note on the Inception Score (https://arxiv.org/pdf/1801.01973.pdf)</li>
</ol>

<h2 id="evaluating-black-box-generative-models">Evaluating (Black-Box) Generative Models</h2>
<p>In contrast to supervised learning, Generative Adversarial Networks lack an objective function that measures “What is realistic?”, which makes it difficult to compare performance of different models.</p>

<p>Why is it so hard?</p>
<ul>
  <li>The real data distribution p(x) is unknown</li>
  <li>The explicit generative distribution q(x) is unknown. (ex. GANs uses random noise vectors for the latent variable)</li>
</ul>

<h2 id="some-previous-metrics-for-the-evaluation-of-generative-models">Some previous metrics for the evaluation of generative models</h2>
<ul>
  <li>To approximate density function over generated samples and then calculate the likelihood of held-out samples</li>
  <li>To apply a pre-trained neural network to generated images and calculate statistics of its output or at a particular hidden layer.(Inception Score approach)</li>
  <li>Use a crowd-sourcing platform (Amazon Mechanical Turk) to evaluate a large number of GAN generated images.</li>
</ul>

<h2 id="what-is-inception-score">What is Inception Score?</h2>
<p>The <strong>Inception Score</strong> is a metric for automatically evalutating the quality of image by generative adversarial networks. (<a href="https://arxiv.org/pdf/1606.03498.pdf">Salimans et al.2016</a>)</p>

<p>The Inception Score uses an Inception v3 Network pre-trained on ImageNet and calculates a statistic of the network’s outputs when applied to generated images. The probability of the image belonging to each class is predicted and then, theses predictions are summarized into the Inception Score.</p>

<h3 id="criterions">Criterions</h3>
<ul>
  <li>Image Quality : The generated image should be sharp rather than blurry</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>p(y</td>
          <td>x) should be low entropy : the inception network should be highly confident there is a single object in the image</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>Image Diversity : p(y) should be high entropy. (the generative algorithm should output a high diversity of images)</li>
</ul>

<p>informally,</p>
<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Every realistic image should be recognizable, which means that the score distribution for it must be, ideally, dominated by one class.(The entropy of image-wise class distributions, p(y</td>
          <td>x) should have low entropy)</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>Class distribution over the whole sample should be as close to uniform as possible, in other words, a good generator is a diverse generator.(The entropy of the overall distribution,which is p(y), should be high)</li>
</ul>

<p>How to Calculate?
KL divergence = p(y|x) * (log(p(y|x)) – log(p(y)))</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">def</span> <span class="nf">inception_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">images</span> <span class="p">,</span> <span class="n">n_split</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">,</span> <span class="n">eps</span> <span class="o">=</span> <span class="mf">1E-16</span><span class="p">):</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n_part</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">images</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">n_split</span><span class="p">)</span>
    
    <span class="n">y_hat</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_split</span><span class="p">):</span>
        <span class="n">ix_start</span> <span class="p">,</span> <span class="n">ix_end</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">n_part</span> <span class="p">,</span> <span class="p">(</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">n_part</span>
        <span class="n">p_yx</span> <span class="o">=</span> <span class="n">y_hat</span><span class="p">[</span><span class="n">ix_start</span> <span class="p">:</span> <span class="n">ix_end</span><span class="p">]</span>
        <span class="n">p_y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">expand_Dims</span><span class="p">(</span><span class="n">p_yx</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">)</span> 
        <span class="n">D_kl</span> <span class="o">=</span> <span class="n">p_yx</span> <span class="o">*</span> <span class="p">(</span><span class="n">log</span> <span class="p">(</span><span class="n">p_yx</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">p_y</span> <span class="o">+</span> <span class="n">eps</span><span class="p">))</span>
        <span class="n">D_kl_sum</span> <span class="o">=</span> <span class="n">D_kl</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">scores</span><span class="p">.</span><span class="n">append</span><span class="p">(</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">D_kl_sum</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">std</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="issues-with-the-inception-score">Issues With the Inception Score</h2>
<ol>
  <li>Suboptimalities of the Inception Score itself</li>
  <li>Problems with the popular usage of the Inception Score</li>
</ol>

<p>It is extremely important when reporting the Inception Score of an algorithm to include some alternative scroe demonstrating that the model is not overfitting to training data, validating that the high score achieved is not simply replaying the training data.</p>

<h1 id="references">References</h1>
<ul>
  <li>https://machinelearningmastery.com/how-to-implement-the-inception-score-from-scratch-for-evaluating-generated-images/</li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#deep-learning" class="page__taxonomy-item" rel="tag">deep-learning</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2022-06-08T00:00:00+09:00">June 8, 2022</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Inception+scores%20http%3A%2F%2Flocalhost%3A4000%2Fdeep-learning%2Finception-scores%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fdeep-learning%2Finception-scores%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fdeep-learning%2Finception-scores%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/deep-learning/anogan/" class="pagination--pager" title="AnoGAN
">Previous</a>
    
    
      <a href="/about/" class="pagination--pager" title="About
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/about/" rel="permalink">About
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Hello world
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/deep-learning/anogan/" rel="permalink">AnoGAN
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="lsjj096@gmail.com; lsjj096@snu.ac.kr" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
        
      
        
          <li><a href="https://github.com/seungjunlee96" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Seungjun Lee. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
